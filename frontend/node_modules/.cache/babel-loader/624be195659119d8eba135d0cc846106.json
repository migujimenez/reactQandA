{"ast":null,"code":"import { webAPIUrl } from './AppSettings';\nexport const http = async config => {\n  const request = new Request(`${webAPIUrl}${config.path}`, {\n    method: config.method || 'get',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: config.body ? JSON.stringify(config.body) : undefined\n  });\n\n  if (config.accesToken) {\n    request.headers.set('authorization', `bearer ${config.accesToken}`);\n  }\n\n  const response = await fetch(request);\n\n  if (response.ok) {\n    const body = await response.json();\n    return {\n      ok: response.ok,\n      body\n    };\n  } else {\n    logError(request, response);\n    return {\n      ok: response.ok\n    };\n  }\n};\n\nconst logError = async (request, response) => {\n  const contentType = response.headers.get('content-type');\n  let body;\n\n  if (contentType && contentType.indexOf('application/json') !== -1) {\n    body = await response.json();\n  } else {\n    body = await request.text();\n  }\n\n  console.error(`Error requesting ${request.method}${request.url}`, body);\n};","map":{"version":3,"sources":["C:/MyApps/reactQandA/frontend/src/http.ts"],"names":["webAPIUrl","http","config","request","Request","path","method","headers","body","JSON","stringify","undefined","accesToken","set","response","fetch","ok","json","logError","contentType","get","indexOf","text","console","error","url"],"mappings":"AACA,SAASA,SAAT,QAA0B,eAA1B;AAcA,OAAO,MAAMC,IAAI,GAAG,MAClBC,MADkB,IAEc;AAChC,QAAMC,OAAO,GAAG,IAAIC,OAAJ,CAAa,GAAEJ,SAAU,GAAEE,MAAM,CAACG,IAAK,EAAvC,EAA0C;AACxDC,IAAAA,MAAM,EAAEJ,MAAM,CAACI,MAAP,IAAiB,KAD+B;AAExDC,IAAAA,OAAO,EAAE;AAAE,sBAAgB;AAAlB,KAF+C;AAGxDC,IAAAA,IAAI,EAAEN,MAAM,CAACM,IAAP,GAAcC,IAAI,CAACC,SAAL,CAAeR,MAAM,CAACM,IAAtB,CAAd,GAA4CG;AAHM,GAA1C,CAAhB;;AAKA,MAAIT,MAAM,CAACU,UAAX,EAAuB;AACrBT,IAAAA,OAAO,CAACI,OAAR,CAAgBM,GAAhB,CAAoB,eAApB,EAAsC,UAASX,MAAM,CAACU,UAAW,EAAjE;AACD;;AACD,QAAME,QAAQ,GAAG,MAAMC,KAAK,CAACZ,OAAD,CAA5B;;AACA,MAAIW,QAAQ,CAACE,EAAb,EAAiB;AACf,UAAMR,IAAI,GAAG,MAAMM,QAAQ,CAACG,IAAT,EAAnB;AACA,WAAO;AAAED,MAAAA,EAAE,EAAEF,QAAQ,CAACE,EAAf;AAAmBR,MAAAA;AAAnB,KAAP;AACD,GAHD,MAGO;AACLU,IAAAA,QAAQ,CAACf,OAAD,EAAUW,QAAV,CAAR;AACA,WAAO;AAAEE,MAAAA,EAAE,EAAEF,QAAQ,CAACE;AAAf,KAAP;AACD;AACF,CAnBM;;AAqBP,MAAME,QAAQ,GAAG,OAAOf,OAAP,EAAyBW,QAAzB,KAAgD;AAC/D,QAAMK,WAAW,GAAGL,QAAQ,CAACP,OAAT,CAAiBa,GAAjB,CAAqB,cAArB,CAApB;AACA,MAAIZ,IAAJ;;AACA,MAAIW,WAAW,IAAIA,WAAW,CAACE,OAAZ,CAAoB,kBAApB,MAA4C,CAAC,CAAhE,EAAmE;AACjEb,IAAAA,IAAI,GAAG,MAAMM,QAAQ,CAACG,IAAT,EAAb;AACD,GAFD,MAEO;AACLT,IAAAA,IAAI,GAAG,MAAML,OAAO,CAACmB,IAAR,EAAb;AACD;;AACDC,EAAAA,OAAO,CAACC,KAAR,CAAe,oBAAmBrB,OAAO,CAACG,MAAO,GAAEH,OAAO,CAACsB,GAAI,EAA/D,EAAkEjB,IAAlE;AACD,CATD","sourcesContent":["import { isGetAccessor } from 'typescript';\r\nimport { webAPIUrl } from './AppSettings';\r\n\r\nexport interface HttpRequest<REQB> {\r\n  path: string;\r\n  method?: string;\r\n  body?: REQB;\r\n  accesToken?: string;\r\n}\r\n\r\nexport interface HttpResponse<RESB> {\r\n  ok: boolean;\r\n  body?: RESB;\r\n}\r\n\r\nexport const http = async <RESB, REQB = undefined>(\r\n  config: HttpRequest<REQB>,\r\n): Promise<HttpResponse<RESB>> => {\r\n  const request = new Request(`${webAPIUrl}${config.path}`, {\r\n    method: config.method || 'get',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: config.body ? JSON.stringify(config.body) : undefined,\r\n  });\r\n  if (config.accesToken) {\r\n    request.headers.set('authorization', `bearer ${config.accesToken}`);\r\n  }\r\n  const response = await fetch(request);\r\n  if (response.ok) {\r\n    const body = await response.json();\r\n    return { ok: response.ok, body };\r\n  } else {\r\n    logError(request, response);\r\n    return { ok: response.ok };\r\n  }\r\n};\r\n\r\nconst logError = async (request: Request, response: Response) => {\r\n  const contentType = response.headers.get('content-type');\r\n  let body: any;\r\n  if (contentType && contentType.indexOf('application/json') !== -1) {\r\n    body = await response.json();\r\n  } else {\r\n    body = await request.text();\r\n  }\r\n  console.error(`Error requesting ${request.method}${request.url}`, body);\r\n};\r\n"]},"metadata":{},"sourceType":"module"}